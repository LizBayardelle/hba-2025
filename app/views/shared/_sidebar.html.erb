<!-- Left Sidebar Navigation -->
<aside
  id="sidebar"
  class="w-64 flex flex-col transition-transform duration-300 ease-in-out fixed left-0 top-0 z-50 -translate-x-full md:translate-x-0 md:relative"
  style="background: #1D1D1F; height: 100vh; box-shadow: 4px 0 24px rgba(0, 0, 0, 0.4); border-right: 0.5px solid rgba(199, 199, 204, 0.2); font-family: 'Inter', sans-serif;">

  <div class="px-5 py-6 text-white flex-1 overflow-y-auto">
    <!-- Close button for mobile -->
    <div class="md:hidden flex justify-end mb-4">
      <button
        id="sidebar-close"
        class="w-8 h-8 rounded-lg hover:bg-white/10 flex items-center justify-center transition">
        <i class="fa-solid fa-xmark text-xl"></i>
      </button>
    </div>

    <!-- Logo Area -->
    <%= link_to root_path, class: "flex items-center gap-3 mb-8 hover:opacity-80 transition-opacity duration-200" do %>
      <%= image_tag "HabitBeaver Logo.png", class: "w-10 h-10", alt: "Habit Beaver Logo" %>
      <div>
        <h1 class="text-4xl font-display" style="color: #FFFFFF;">Habit Beaver</h1>
        <% if user_signed_in? %>
          <p class="text-xs tabular-nums" id="selected-date" style="color: #8E8E93; letter-spacing: 0.05em; text-transform: uppercase; font-weight: 200; font-variant-numeric: tabular-nums;">
            <%= Time.zone.today.strftime("%b %d").upcase %> <span style="opacity: 0.5;">&middot;</span> <span id="current-time" data-timezone="<%= ActiveSupport::TimeZone::MAPPING[current_user.timezone] %>" data-tz-abbr="<%= Time.zone.now.strftime("%Z") %>"><%= Time.zone.now.strftime("%I:%M %p %Z") %></span>
          </p>
        <% else %>
          <p class="text-xs" style="color: #8E8E93; letter-spacing: 0.05em; text-transform: uppercase; font-weight: 200;">Build better habits</p>
        <% end %>
      </div>
    <% end %>

    <% if user_signed_in? %>
      <script>
        (function() {
          const timeElement = document.getElementById('current-time');
          if (timeElement) {
            const tzAbbr = timeElement.dataset.tzAbbr;
            function updateTime() {
              const now = new Date();
              const timezone = timeElement.dataset.timezone;
              const options = {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true,
                timeZone: timezone
              };
              timeElement.textContent = now.toLocaleTimeString('en-US', options) + ' ' + tzAbbr;
            }
            setInterval(updateTime, 1000);
          }
        })();
      </script>
    <% end %>

    <!-- Navigation Items -->
    <nav class="space-y-0">
      <%= link_to dashboard_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(dashboard_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
        <i class="fa-solid fa-gauge w-5 text-center" style="color: <%= current_page?(dashboard_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
        <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(dashboard_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(dashboard_path) ? '1' : '0.7' %>;">Dashboard</span>
      <% end %>
      <% prep_active = current_page?(daily_prep_path) || current_page?(daily_prep_manage_path) || current_page?(daily_prep_answers_path) %>
      <%= link_to daily_prep_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: prep_active ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
        <i class="fa-solid fa-clipboard-check w-5 text-center" style="color: <%= prep_active ? '#FFFFFF' : '#C7C7CC' %>;"></i>
        <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= prep_active ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= prep_active ? '1' : '0.7' %>;">Daily Prep</span>
      <% end %>
      <%= link_to journal_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(journal_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
        <i class="fa-solid fa-book w-5 text-center" style="color: <%= current_page?(journal_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
        <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(journal_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(journal_path) ? '1' : '0.7' %>;">Journal</span>
      <% end %>
      <% habits_url = user_signed_in? && current_user.default_habits_grouping != 'category' ? habits_path(view: current_user.default_habits_grouping) : habits_path %>
      <%= link_to habits_url, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(habits_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
        <i class="fa-solid fa-chart-line w-5 text-center" style="color: <%= current_page?(habits_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
        <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(habits_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(habits_path) ? '1' : '0.7' %>;">Habits</span>
      <% end %>
      <% tasks_url = user_signed_in? && current_user.default_tasks_grouping != 'status' ? tasks_path(groupBy: current_user.default_tasks_grouping) : tasks_path %>
      <%= link_to tasks_url, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(tasks_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
        <i class="fa-solid fa-check w-5 text-center" style="color: <%= current_page?(tasks_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
        <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(tasks_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(tasks_path) ? '1' : '0.7' %>;">Tasks</span>
      <% end %>
    </nav>

    <!-- Attachments Section -->
    <div class="mt-5">
      <div class="flex items-center justify-between mb-2 pb-1 border-b" style="border-bottom-color: rgba(199, 199, 204, 0.2);">
        <h3 class="text-sm" style="color: #C7C7CC; letter-spacing: 0.03em; font-weight: 200; opacity: 0.7;">Attachments</h3>
      </div>
      <div class="space-y-0">
        <% documents_url = user_signed_in? && current_user.default_documents_grouping != 'type' ? documents_path(groupBy: current_user.default_documents_grouping) : documents_path %>
        <%= link_to documents_url, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(documents_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
          <i class="fa-solid fa-file-alt w-5 text-center" style="color: <%= current_page?(documents_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(documents_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(documents_path) ? '1' : '0.7' %>;">Documents</span>
        <% end %>
        <% lists_url = user_signed_in? && current_user.default_lists_grouping != 'type' ? lists_path(groupBy: current_user.default_lists_grouping) : lists_path %>
        <%= link_to lists_url, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(lists_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
          <i class="fa-solid fa-list-check w-5 text-center" style="color: <%= current_page?(lists_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(lists_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(lists_path) ? '1' : '0.7' %>;">Lists</span>
        <% end %>
      </div>
    </div>

    <!-- Categories Section -->
    <div class="mt-5" x-data="{
      showModal: false,
      selectedColor: '#6B8A99',
      selectedIcon: 'fa-check',
      categoryName: '',
      hexToRgb(hex) {
        const clean = hex.replace('#', '');
        return { r: parseInt(clean.substr(0,2),16), g: parseInt(clean.substr(2,2),16), b: parseInt(clean.substr(4,2),16) };
      },
      rgbToHex(r,g,b) {
        return '#' + [r,g,b].map(c => Math.round(Math.max(0,Math.min(255,c))).toString(16).padStart(2,'0')).join('').toUpperCase();
      },
      rgbToHsl(r,g,b) {
        r/=255; g/=255; b/=255;
        const max=Math.max(r,g,b), min=Math.min(r,g,b), l=(max+min)/2;
        let h=0, s=0;
        if(max!==min) { const d=max-min; s=l>0.5?d/(2-max-min):d/(max+min); h=max===r?((g-b)/d+(g<b?6:0))/6:max===g?((b-r)/d+2)/6:((r-g)/d+4)/6; }
        return {h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)};
      },
      hslToRgb(h,s,l) {
        h/=360; s/=100; l/=100;
        if(s===0) return {r:Math.round(l*255),g:Math.round(l*255),b:Math.round(l*255)};
        const hue2rgb=(p,q,t)=>{if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;};
        const q=l<0.5?l*(1+s):l+s-l*s, p=2*l-q;
        return {r:Math.round(hue2rgb(p,q,h+1/3)*255),g:Math.round(hue2rgb(p,q,h)*255),b:Math.round(hue2rgb(p,q,h-1/3)*255)};
      },
      getLightColor(hex) {
        const rgb=this.hexToRgb(hex), hsl=this.rgbToHsl(rgb.r,rgb.g,rgb.b);
        const newRgb=this.hslToRgb(hsl.h,Math.max(hsl.s*0.4,10),92);
        return this.rgbToHex(newRgb.r,newRgb.g,newRgb.b);
      },
      getDarkColor(hex) {
        const rgb=this.hexToRgb(hex), hsl=this.rgbToHsl(rgb.r,rgb.g,rgb.b);
        const newRgb=this.hslToRgb(hsl.h,Math.min(hsl.s*1.2,80),28);
        return this.rgbToHex(newRgb.r,newRgb.g,newRgb.b);
      }
    }">
      <div class="flex items-center justify-between mb-2 pb-1 border-b" style="border-bottom-color: rgba(199, 199, 204, 0.2);">
        <h3 class="text-sm" style="color: #C7C7CC; letter-spacing: 0.03em; font-weight: 200; opacity: 0.7;">Categories</h3>
        <button @click="showModal = true" class="w-6 h-6 flex items-center justify-center hover:bg-white/10 transition-colors duration-150" style="color: #C7C7CC; opacity: 0.7;">
          <i class="fa-solid fa-plus text-xs"></i>
        </button>
      </div>
      <div class="space-y-0">
        <% if user_signed_in? && current_user.categories.active.ordered.any? %>
          <% current_user.categories.active.ordered.each do |category| %>
            <% is_active = @category && @category.id == category.id %>
            <%= link_to category_path(category), class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: is_active ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
              <i class="fa-solid <%= category.icon %> w-5 text-center" style="color: <%= category.color %>;"></i>
              <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= is_active ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= is_active ? '1' : '0.7' %>;"><%= category.name %></span>
            <% end %>
          <% end %>
        <% else %>
          <p class="text-xs px-4 py-1" style="color: #8E8E93; font-weight: 100;">No categories yet</p>
        <% end %>
      </div>

      <!-- New Category Modal -->
      <template x-teleport="body">
        <div x-show="showModal" @click.self="showModal = false" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" style="display: none;">
        <div @click.stop class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
          <h2 class="text-2xl font-bold mb-6 display-font" style="color: #1d3e4c;">New Category</h2>

          <%= form_with model: Category.new, url: categories_path, method: :post, local: true do |f| %>
            <!-- Preview Box -->
            <div class="mb-6">
              <p class="text-xs font-semibold mb-2" style="color: #566e78;">PREVIEW</p>
              <div class="p-4 rounded-lg border-2" :style="'background-color: ' + getLightColor(selectedColor) + '; border-color: ' + selectedColor">
                <div class="flex items-center gap-3">
                  <div class="w-8 h-8 rounded-lg flex items-center justify-center shadow-sm" :style="'background-color: ' + selectedColor">
                    <i :class="'fa-solid ' + selectedIcon" class="text-white"></i>
                  </div>
                  <span class="font-bold display-font" :style="'color: ' + getDarkColor(selectedColor)" x-text="categoryName || 'My Category'"></span>
                </div>
              </div>
            </div>

            <!-- Category Name -->
            <div class="mb-5">
              <%= f.label :name, "Category Name", class: "block text-sm font-semibold mb-2", style: "color: #1d3e4c;" %>
              <%= f.text_field :name, "x-model": "categoryName", placeholder: "e.g., Health & Fitness", class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light", style: "border-color: #E8EEF1; color: #1d3e4c;" %>
            </div>

            <!-- Description -->
            <div class="mb-5">
              <%= f.label :description, "Description (Optional)", class: "block text-sm font-semibold mb-2", style: "color: #1d3e4c;" %>
              <%= f.text_area :description, rows: 2, placeholder: "e.g., Daily exercise and nutrition habits", class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light resize-none", style: "border-color: #E8EEF1; color: #1d3e4c;" %>
            </div>

            <!-- Hidden fields for color and icon -->
            <%= f.hidden_field :color, "x-model": "selectedColor" %>
            <%= f.hidden_field :icon, "x-model": "selectedIcon" %>

            <!-- Icon Selector -->
            <div class="mb-5">
              <label class="block text-sm font-semibold mb-2" style="color: #1d3e4c;">Icon</label>
              <div class="grid grid-cols-8 md:grid-cols-12 gap-2 max-h-48 overflow-y-auto p-2 border rounded-lg" style="border-color: #E8EEF1;">
                <button type="button" @click="selectedIcon = 'fa-check'" :class="selectedIcon === 'fa-check' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-check text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-dumbbell'" :class="selectedIcon === 'fa-dumbbell' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-dumbbell text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-book'" :class="selectedIcon === 'fa-book' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-book text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-heart'" :class="selectedIcon === 'fa-heart' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-heart text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-briefcase'" :class="selectedIcon === 'fa-briefcase' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-briefcase text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-utensils'" :class="selectedIcon === 'fa-utensils' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-utensils text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-bed'" :class="selectedIcon === 'fa-bed' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-bed text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-apple-whole'" :class="selectedIcon === 'fa-apple-whole' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-apple-whole text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-mug-hot'" :class="selectedIcon === 'fa-mug-hot' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-mug-hot text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-person-running'" :class="selectedIcon === 'fa-person-running' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-person-running text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-pills'" :class="selectedIcon === 'fa-pills' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-pills text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-brain'" :class="selectedIcon === 'fa-brain' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-brain text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-music'" :class="selectedIcon === 'fa-music' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-music text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-paintbrush'" :class="selectedIcon === 'fa-paintbrush' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-paintbrush text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-droplet'" :class="selectedIcon === 'fa-droplet' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-droplet text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-users'" :class="selectedIcon === 'fa-users' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-users text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-star'" :class="selectedIcon === 'fa-star' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-star text-sm" style="color: #1d3e4c;"></i>
                </button>
                <button type="button" @click="selectedIcon = 'fa-pen'" :class="selectedIcon === 'fa-pen' ? 'border-theme-blue bg-theme-blue-light/10' : 'border-gray-200'" class="w-8 h-8 rounded-lg border-2 hover:border-theme-blue flex items-center justify-center transition">
                  <i class="fa-solid fa-pen text-sm" style="color: #1d3e4c;"></i>
                </button>
              </div>
            </div>

            <!-- Color Selector -->
            <div class="mb-6">
              <label class="block text-sm font-semibold mb-2" style="color: #1d3e4c;">Color</label>
              <div class="flex gap-2 p-2 border rounded-lg overflow-x-auto" style="border-color: #E8EEF1;">
                <button type="button" @click="selectedColor = '#6B8A99'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition relative flex items-center justify-center" :class="selectedColor === '#6B8A99' ? 'border-gray-800' : 'border-white'" style="background-color: #6B8A99;">
                  <i x-show="selectedColor === '#6B8A99'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#9C8B7E'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#9C8B7E' ? 'border-gray-800' : 'border-white'" style="background-color: #9C8B7E;">
                  <i x-show="selectedColor === '#9C8B7E'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#F8796D'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#F8796D' ? 'border-gray-800' : 'border-white'" style="background-color: #F8796D;">
                  <i x-show="selectedColor === '#F8796D'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#FFA07A'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#FFA07A' ? 'border-gray-800' : 'border-white'" style="background-color: #FFA07A;">
                  <i x-show="selectedColor === '#FFA07A'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#E5C730'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#E5C730' ? 'border-gray-800' : 'border-white'" style="background-color: #E5C730;">
                  <i x-show="selectedColor === '#E5C730'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#A8A356'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#A8A356' ? 'border-gray-800' : 'border-white'" style="background-color: #A8A356;">
                  <i x-show="selectedColor === '#A8A356'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#7CB342'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#7CB342' ? 'border-gray-800' : 'border-white'" style="background-color: #7CB342;">
                  <i x-show="selectedColor === '#7CB342'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#6EE7B7'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#6EE7B7' ? 'border-gray-800' : 'border-white'" style="background-color: #6EE7B7;">
                  <i x-show="selectedColor === '#6EE7B7'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#22D3EE'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#22D3EE' ? 'border-gray-800' : 'border-white'" style="background-color: #22D3EE;">
                  <i x-show="selectedColor === '#22D3EE'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#6366F1'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#6366F1' ? 'border-gray-800' : 'border-white'" style="background-color: #6366F1;">
                  <i x-show="selectedColor === '#6366F1'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#A78BFA'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#A78BFA' ? 'border-gray-800' : 'border-white'" style="background-color: #A78BFA;">
                  <i x-show="selectedColor === '#A78BFA'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#E879F9'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#E879F9' ? 'border-gray-800' : 'border-white'" style="background-color: #E879F9;">
                  <i x-show="selectedColor === '#E879F9'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#FB7185'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#FB7185' ? 'border-gray-800' : 'border-white'" style="background-color: #FB7185;">
                  <i x-show="selectedColor === '#FB7185'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
                <button type="button" @click="selectedColor = '#9CA3A8'" class="w-8 h-8 rounded-full border-2 shadow-md hover:scale-110 transition flex items-center justify-center" :class="selectedColor === '#9CA3A8' ? 'border-gray-800' : 'border-white'" style="background-color: #9CA3A8;">
                  <i x-show="selectedColor === '#9CA3A8'" class="fa-solid fa-check text-white text-sm font-black"></i>
                </button>
              </div>
            </div>

            <!-- Buttons -->
            <div class="flex gap-3">
              <button type="button" @click="showModal = false" class="flex-1 py-3 px-4 rounded-lg font-semibold border-2 transition" style="color: #1d3e4c; border-color: #E8EEF1;">
                Cancel
              </button>
              <%= f.submit "Create Category", class: "flex-1 py-3 px-4 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition transform hover:scale-[1.02]", style: "background: linear-gradient(135deg, #1d3e4c, #45606b);" %>
            </div>
          <% end %>
        </div>
        </div>
      </template>
    </div>

    <!-- Organization Section -->
    <div class="mt-5">
      <div class="flex items-center justify-between mb-2 pb-1 border-b" style="border-bottom-color: rgba(199, 199, 204, 0.2);">
        <h3 class="text-sm" style="color: #C7C7CC; letter-spacing: 0.03em; font-weight: 200; opacity: 0.7;">Organization</h3>
      </div>
      <div class="space-y-0">
        <%= link_to tags_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(tags_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
          <i class="fa-solid fa-tags w-5 text-center" style="color: <%= current_page?(tags_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(tags_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(tags_path) ? '1' : '0.7' %>;">Tags</span>
        <% end %>
      </div>
    </div>

    <!-- Admin Section -->
    <div class="mt-5">
      <div class="flex items-center justify-between mb-2 pb-1 border-b" style="border-bottom-color: rgba(199, 199, 204, 0.2);">
        <h3 class="text-sm" style="color: #C7C7CC; letter-spacing: 0.03em; font-weight: 200; opacity: 0.7;">Admin</h3>
      </div>
      <div class="space-y-0">
        <%= link_to analytics_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(analytics_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
          <i class="fa-solid fa-chart-column w-5 text-center" style="color: <%= current_page?(analytics_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(analytics_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(analytics_path) ? '1' : '0.7' %>;">Analytics</span>
        <% end %>
        <%= link_to settings_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(settings_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
          <i class="fa-solid fa-gear w-5 text-center" style="color: <%= current_page?(settings_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(settings_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(settings_path) ? '1' : '0.7' %>;">Settings</span>
        <% end %>
        <% if user_signed_in? %>
          <%= link_to edit_user_registration_path, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm", style: current_page?(edit_user_registration_path) ? "background-color: rgba(255, 255, 255, 0.08);" : "" do %>
            <i class="fa-solid fa-user w-5 text-center" style="color: <%= current_page?(edit_user_registration_path) ? '#FFFFFF' : '#C7C7CC' %>;"></i>
            <span style="font-weight: 200; letter-spacing: 0.03em; color: <%= current_page?(edit_user_registration_path) ? '#FFFFFF' : '#C7C7CC' %>; opacity: <%= current_page?(edit_user_registration_path) ? '1' : '0.7' %>;">My Account</span>
          <% end %>
          <%= button_to destroy_user_session_path, method: :delete, class: "flex items-center gap-3 py-1.5 rounded-lg transition-all duration-150 text-sm w-full text-left", style: "" do %>
            <i class="fa-solid fa-arrow-right-from-bracket w-5 text-center" style="color: #C7C7CC;"></i>
            <span style="font-weight: 200; letter-spacing: 0.03em; color: #C7C7CC; opacity: 0.7;">Sign Out</span>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>

  <% unless user_signed_in? %>
    <!-- Sign In/Sign Up for logged out users -->
    <div class="p-4 border-t text-white" style="border-color: rgba(199, 199, 204, 0.2);">
      <div class="space-y-1">
        <%= link_to new_user_session_path, class: "flex items-center gap-3 pl-4 pr-0 py-1.5 rounded-lg hover:bg-white/10 transition text-sm" do %>
          <i class="fa-solid fa-arrow-right-to-bracket w-5 text-center" style="color: #C7C7CC;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: #C7C7CC; opacity: 0.7;">Sign In</span>
        <% end %>
        <%= link_to new_user_registration_path, class: "flex items-center gap-3 pl-4 pr-0 py-1.5 rounded-lg hover:bg-white/10 transition text-sm" do %>
          <i class="fa-solid fa-user-plus w-5 text-center" style="color: #C7C7CC;"></i>
          <span style="font-weight: 200; letter-spacing: 0.03em; color: #C7C7CC; opacity: 0.7;">Create Account</span>
        <% end %>
      </div>
    </div>
  <% end %>
</aside>
