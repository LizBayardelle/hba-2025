<!-- Modal for displaying habit content -->
<div class="fixed inset-0 flex items-center justify-center p-4 z-50" id="content-modal" style="background: rgba(0, 0, 0, 0.6); -webkit-backdrop-filter: blur(4px); backdrop-filter: blur(4px);" onclick="if(event.target === this) closeHabitContentModal()">
  <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden" onclick="event.stopPropagation()">
    <!-- Header -->
    <div class="p-6 border-b flex items-center justify-between" style="border-color: #E8EEF1;">
      <h2 class="text-2xl font-bold display-font" style="color: #1d3e4c;">
        <%= @habit_content.title %>
      </h2>
      <button onclick="closeHabitContentModal()" class="w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition">
        <i class="fa-solid fa-times" style="color: #657b84;"></i>
      </button>
    </div>

    <!-- Content Body -->
    <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 140px);">
      <% case @habit_content.content_type %>
      <% when 'youtube' %>
        <% if @habit_content.youtube_embed_url %>
          <div class="aspect-video w-full">
            <iframe
              width="100%"
              height="100%"
              src="<%= @habit_content.youtube_embed_url %>"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              class="rounded-lg"></iframe>
          </div>
        <% else %>
          <p class="text-center py-8" style="color: #657b84;">Invalid YouTube URL</p>
        <% end %>

      <% when 'video', 'link' %>
        <div class="text-center py-8">
          <%= link_to @habit_content.metadata['url'], @habit_content.metadata['url'],
              target: '_blank',
              class: "inline-flex items-center gap-2 px-6 py-3 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition",
              style: "background: linear-gradient(135deg, #1d3e4c, #45606b);" do %>
            <i class="fa-solid fa-external-link-alt"></i>
            Open Link
          <% end %>
        </div>

      <% when 'document' %>
        <div class="prose max-w-none">
          <%= @habit_content.body %>
        </div>
      <% end %>
    </div>

    <!-- Footer -->
    <div class="p-6 border-t flex justify-between" style="border-color: #E8EEF1;">
      <div class="flex gap-2">
        <%= link_to edit_habit_habit_content_path(@habit, @habit_content),
            class: "px-4 py-2 rounded-lg font-semibold border-2 transition",
            style: "color: #1d3e4c; border-color: #E8EEF1;" do %>
          <i class="fa-solid fa-edit mr-2"></i>Edit
        <% end %>
        <%= button_to habit_habit_content_path(@habit, @habit_content),
            method: :delete,
            data: { confirm: 'Are you sure?' },
            class: "px-4 py-2 rounded-lg font-semibold border-2 transition",
            style: "color: #DC2626; border-color: #FEE2E2;" do %>
          <i class="fa-solid fa-trash mr-2"></i>Delete
        <% end %>
      </div>
      <button onclick="closeHabitContentModal()"
          class="px-6 py-2 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition"
          style="background: linear-gradient(135deg, #1d3e4c, #45606b);">
        Close
      </button>
    </div>
  </div>
</div>
