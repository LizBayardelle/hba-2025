<!-- Edit Habit Modal -->
<div x-show="editHabitId === <%= habit.id %>" @click.self="editHabitId = null" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4" style="display: none; z-index: 100;">
  <div @click.stop class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
    <h2 class="text-2xl font-bold mb-6 display-font" style="color: #1D1D1F;">Edit Habit</h2>

    <%= form_with model: habit, url: category_habit_path(category, habit), method: :patch, local: true do |f| %>
      <!-- Habit Name -->
      <div class="mb-6">
        <%= f.label :name, class: "block mb-2" %>
        <%= f.text_field :name, class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light", style: "border-color: #E8EEF1;" %>
      </div>

      <!-- Frequency: Times per Period -->
      <div class="mb-6">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <%= f.label :target_count, "Times", class: "block mb-2 text-sm" %>
            <%= f.number_field :target_count, class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light", style: "border-color: #E8EEF1;", min: 1 %>
          </div>
          <div>
            <%= f.label :frequency_type, "Per", class: "block mb-2 text-sm" %>
            <%= f.select :frequency_type,
                [['Day', 'day'], ['Week', 'week'], ['Month', 'month'], ['Year', 'year']],
                {},
                class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light",
                style: "border-color: #E8EEF1;" %>
          </div>
        </div>
      </div>

      <!-- Time of Day -->
      <div class="mb-6">
        <%= f.label :time_of_day, class: "block mb-2" %>
        <%= f.select :time_of_day,
            [['Morning', 'morning'], ['Afternoon', 'afternoon'], ['Evening', 'evening'], ['Anytime', 'anytime']],
            {},
            class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light",
            style: "border-color: #E8EEF1;" %>
      </div>

      <!-- Importance Level -->
      <div class="mb-6">
        <%= f.label :importance_level_id, "Importance Level", class: "block mb-2" %>
        <%= f.collection_select :importance_level_id,
            current_user.importance_levels.order(:rank),
            :id,
            :name,
            { include_blank: "Select importance level" },
            class: "w-full px-4 py-3 rounded-lg border-2 focus:outline-none transition font-light",
            style: "border-color: #E8EEF1;" %>
      </div>

      <!-- Actions -->
      <div class="flex gap-3 justify-between">
        <div>
          <%= link_to "Delete", category_habit_path(category, habit), method: :delete, data: { confirm: "Are you sure?" }, class: "px-6 py-3 rounded-lg font-semibold border-2 transition inline-block", style: "color: #DC2626; border-color: #FEE2E2;" %>
        </div>
        <div class="flex gap-3">
          <button type="button" @click="editHabitId = null" class="px-6 py-3 rounded-lg font-semibold border-2 transition" style="color: #1D1D1F; border-color: #E8EEF1;">
            Cancel
          </button>
          <%= f.submit "Update Habit", class: "px-6 py-3 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition cursor-pointer", style: "background: linear-gradient(135deg, #1D1D1F, #45606b);" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
